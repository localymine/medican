<?phpob_start();/*Plugin Name:Custom  Frontend  Login Registration FormPlugin URI: http://dropsofvisions.com/Description: Simple Frontend Login  Registration Form This plugin creates a user interface for adding custom registration forms to any post or page on your WordPress website. Simply navigate to the edit page for  post .login form Shortcode: [cflrf_custom_login_form] >Registration Form Shortcode: [cflrf_registration_form]Version: 1.01Author: Anil ShahAuthor URI: http://dropsofvisions.com/*/class cflrf_registration_form{// form propertiesprivate $username;private $email;private $password;function __construct(){add_shortcode('cflrf_registration_form', array($this, 'shortcode'));add_action('wp_enqueue_scripts', array($this, 'cflrf_flat_ui_kit'));}public function registration_form(){unset($_SESSION['counter_value']);?><script type='text/javascript'>function call(){jQuery('#resendid').delay(60000).queue(function (next) {jQuery(this).css('color', '#f8b731');jQuery(this).css('pointer-events','auto');next();});}function myajax(type,code){var otp_code = jQuery('#reg-code').val();var captcha_code = jQuery('#captcha_code').val();jQuery("#preloader").css('display','block');jQuery("#status").css('display','block');jQuery.ajax({type: "POST",url: "<?php echo plugins_url().'/custom-frontend-login-registration-form/ajax.php' ?>",data: { registrationform : jQuery('#regitserform').serialize(), type:type,code:otp_code, captcha_code:captcha_code },dataType: 'json',success: function(result){jQuery("#preloader").css('display','none');jQuery("#status").css('display','none');if(result['type']=='register'){if(result['error'] && result['error']=='1'){jQuery(".alreadyexisterror").html(result['message']);jQuery('#captchaimg').attr('src',' <?php echo plugins_url().'/custom-frontend-login-registration-form/captcha.php'?>?'+"?rand="+Math.random()*1000);}else{jQuery(".alreadyexisterror").html('');jQuery(".tab-container").hide();jQuery('.left_tab').show();jQuery('.otp_info').html('Your OTP Code is:'+ result['message']);jQuery('.customphoneclass').html(result['userphone']);}}if(result['type']=='activate'){jQuery('.resendcodemessage').html('');jQuery(".resend_count").css("display","none");if(result['error'] && result['error']=='1'){jQuery(".codeerror").html(result['errormessage']);jQuery(".success_user").html(result['']);}else{jQuery(".codeerror").html('');//                         jQuery(".success_user").html(result['errormessage']);jQuery(".successfull").css("display","block");jQuery(".total_content").css("display","none");}}if(result['type']=='resend'){jQuery(".codeerror").html('');if(result['resendcodemessage']!=''){jQuery('.resendcodemessage').html(result['resendcodemessage']);}else{jQuery('.resendcodemessage').html('');}//                   jQuery("#resendidtime").hide();if(result['counter']<2){call();}jQuery(".success_user").html('');jQuery(".resend_count").css("display","none");//                   jQuery('.resendcodemessage').html('');jQuery('.otp_info').html('Your OTP Code is:'+ result['message']);if(result['resendtime']=='yes'){jQuery("#resendid").css("pointer-events","none");jQuery("#resendid").css("color","#b2bcc5");//}if(result['counter']>=2){jQuery(".resend_count").css("display","block");jQuery("#resendid").css("pointer-events","none");jQuery("#resendid").css("color","#b2bcc5");jQuery(".codeerror").html('');//                      jQuery("#resendidtime").hide();jQuery('.resendcodemessage').html('');}else{jQuery(".resend_count").css("display","none");//                       jQuery('.resendcodemessage').html('');}}}});}jQuery.validator.addMethod('customphone', function (value, element) {return this.optional(element) || /^(\+91-|\+91|0)?\d{10}$/.test(value);}, "Please enter a valid phone.");jQuery(document).ready(function () {jQuery('.custommessageclass ').on('input', function() {jQuery(".alreadyexisterror").html('');jQuery(".codeerror").html('');});jQuery('#regitserform').validate({ // initialize the pluginonkeyup: function(element) {jQuery(element).valid()},rules: {regemail: {required: true,email: true,maxlength: 100},regpassword: {required: true,minlength: 5,maxlength: 100},captcha_code: {required: true},regphone:{customphone: true,maxlength: 100}},submitHandler: function (form) { // for demomyajax('register');}});});</script><div class='successfull' style='display: none'>	<div class='top top_formcontent'>	<div class='top_bottom'>	<img src='<?php echo get_stylesheet_directory_uri().'/images/icontick.png'?>' class='successimage'>	<h2>Successful</h2>	</div>	<div class='bottom'>Thanks for signing up of <a class="consumer_success" href='<?php echo get_site_url(); ?>'>www.webnhathuoc.vn</a> </div>		<div class='bottom'> <a href="<?php echo get_home_url(); ?>" class='asuccess registerlink'>Back to Homepage</a></div>	</div></div><div class='total_content'><div class="top_formcontent" ><div class="right_tab tab-container" data-tab-index="0"><h3>Sign up as a Consumer account </h3><form  id='regitserform' method="post" action="<?php echo esc_url($_SERVER['REQUEST_URI']); ?>"><div class="login-form"><div class="form-group"><input name="regemail" type="email" class="form-control login-field custommessageclass"placeholder="Email*" id="reg-email"></div><div class="form-group"><input  name="regphone" type="text" class="form-control login-field custommessageclass"placeholder="Phone*" id="reg-phone" required></div><div class="form-group"><input name="regpassword" type="password" class="form-control login-field"placeholder="Password*" id="reg-pass"></div><div class="captchadiv"><div class="captcha_main"><div class="chptcha_head"></div><ul> <li class="captchaimage1"><img src="<?php echo plugins_url().'/custom-frontend-login-registration-form/captcha.php'?>" id="captchaimg"></li><li class="captchaimage2"><input id="captcha_code"  class = "form-control login-field custommessageclass" name="captcha_code" type="text" placeholder="Results*"></li></ul></div></div><div class='bottom_span'> <span class='more_info'> More Information: <a target="_blank" href="<?php echo get_permalink(1428); ?>">About us</a>.</div><input class="btn btn-primary registerlink" type="submit" name="reg_submit" value="SIGN UP"/><span class="alreadyexisterror"></span><!--<div class='bottom_span'> <span class='more_info'> Are you a store? <a  href="<?php // echo get_permalink(1372); ?>">Sign up as a Store account</a></span></div>--></form></div></div><div class="right_tab  left_tab tab-container" data-tab-index="1" style="display:none;"><div class="next_step  <?php echo $_COOKIE['default_school']; ?>"><span class='otp_info'></span><h3>Sign up as a Consumer account </h3><span class='more_info'>Please check the your phone number <b class="customphoneclass">Phone</b> to get OTP code.</span><div class="form-group"><form class="login-form method="post" action=""><input name="reg-code" type="text" class="form-control login-field custommessageclass" value="" placeholder="OTP Code" id="reg-code"><input name="custom_code" type="hidden" value=""><input name="reg_name" type="hidden" value="'.$_POST['reg_name'].'"><input name="reg_email" type="hidden" value="'.$_POST['reg_email'].'"><input name="reg_phone" type="hidden" value="'.$_POST['reg_phone'].'"><input name="reg_password" type="hidden" value="'.$_POST['reg_password'].'"><input class="btn code_submit activess" type="button" onclick='myajax("activate","code")' name="code_submit" value="Activate"/><span class="codeerror"></span><span class="success_user"></span><input id ='resendid' class="btn code_submit" type="button" onclick='myajax("resend")' name="code_resend" value="RE-SEND OTP CODE"/><input  style="display:none;" id ='resendidtime' class="btn code_submit" type="button" onclick='myajax("resend")' name="code_resends" value="RE-SEND OTP CODE"/><span class="resend_count" style='display:none'>You can use resend code only 3 time. </span><span class="resendcodemessage"></span></form></div></div></div></div></div><?php}function registration(){if (is_wp_error($this->validation())) {echo '<div style="margin-bottom: 6px" class="btn btn-block btn-lg btn-danger">';echo '<strong>' . $this->validation()->get_error_message() . '</strong>';echo '</div>';} else {?><?php}}function shortcode(){ob_start();if ($_REQUEST['reg_submit']) {$this->username = $_REQUEST['reg_name'];$this->email = $_REQUEST['reg_email'];$this->password = $_REQUEST['reg_password'];$this->validation();session_start();$_SESSION['start'] = time();if(!isset($_SESSION['code_value'])){$_SESSION['code_value'] = $_SESSION['start'] + (30) ;}$now = time();if($now > $_SESSION['code_value']){unset($_SESSION['code_value']);}$this->registration();}$this->registration_form();//       echo $_SESSION['code_value'];return ob_get_clean();}function cflrf_flat_ui_kit(){//            wp_enqueue_style('bootstrap-css', plugins_url('bootstrap/css/bootstrap.css', __FILE__), false, false, 'screen');wp_enqueue_style('flat-ui-kit', plugins_url('css/flat-ui.css', __FILE__), false, false, 'screen');}}new cflrf_registration_form;// custom frontend login formfunction cflrf_login_form() {?><form method="post" action="<?php echo $_SERVER['REQUEST_URI']; ?>"><div class="login-form"><div class="form-group"><input name="login_name" type="text" class="form-control login-field" value="" placeholder="Username" id="login-name" /><label class="login-field-icon fui-user" for="login-name"></label></div><div class="form-group"><input  name="login_password" type="password" class="form-control login-field" value="" placeholder="Password" id="login-pass" /><label class="login-field-icon fui-lock" for="login-pass"></label></div><input class="btn btn-primary btn-lg btn-block" type="submit"  name="login_submit" value="Log in" /></form></div><?php}function login_check( $username, $password ) {global $user;$creds = array();$creds['user_login'] = $username;$creds['user_password'] =  $password;$creds['remember'] = true;$user = wp_signon( $creds, false );if ( is_wp_error($user) ) {echo $user->get_error_message();}if ( !is_wp_error($user) ) {wp_redirect(home_url('wp-admin'));}}function login_check_process() {if (isset($_POST['login_submit'])) {login_check($_POST['login_name'], $_POST['login_password']);}cflrf_login_form();}function cflrf_custom_ui_kit() {//wp_enqueue_style('bootstrap-css', plugins_url('bootstrap/css/bootstrap.css', __FILE__));wp_enqueue_style('flat-ui-kit', plugins_url('css/flat-ui.css', __FILE__));}add_action('wp_enqueue_scripts', 'cflrf_custom_ui_kit');function cflrf_login_shortcode() {ob_start();login_check_process();return ob_get_clean();}add_shortcode('cflrf_custom_login_form', 'cflrf_login_shortcode');